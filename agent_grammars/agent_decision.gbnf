# Agent Decision Grammar (Chapter 10 §7.3)
# WATCHER step evaluation: proceed / retry / escalate
#
# VERSION: 1.0.0
# DATE: 2026-02-01
# SESSION: 57
#
# Used by: WATCHER _evaluate_with_router() for all Steps 1-6
# Selfplay role: Step evaluations during dispatch_learning_loop() (Steps 3→5→6)
# Purpose: Force the LLM to output exactly {decision, confidence, reasoning}
#
# Example output:
# {"decision":"proceed","confidence":0.92,"reasoning":"Step 5 training completed with val_r2=0.847, exceeding threshold."}

root ::= "{" ws
    "\"decision\"" ws ":" ws decision-value ws "," ws
    "\"confidence\"" ws ":" ws confidence-value ws "," ws
    "\"reasoning\"" ws ":" ws string
    ws "}"

decision-value ::= "\"proceed\"" | "\"retry\"" | "\"escalate\""

confidence-value ::= "0" ("." [0-9]+)? | "1" (".0")? | "0." [0-9]+

string ::= "\"" string-content "\""
string-content ::= ([^"\\] | "\\" ["\\/bfnrt])*

ws ::= [ \t\n\r]*
