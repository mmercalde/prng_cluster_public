{
  "agent_name": "window_optimizer_agent",
  "description": "Step 1: Bayesian window optimization using Optuna TPE. Runs real forward/reverse sieves across 26 GPUs to find optimal window_size, offset, and skip_range parameters.",
  "pipeline_step": 1,
  "version": "1.3.0",
  
  "inputs": [
    "lottery_file",
    "seed_count",
    "prng_type"
  ],
  
  "outputs": [
    "bidirectional_survivors.json",
    "optimal_window_config.json"
  ],
  
  "actions": [
    {
      "type": "run_script",
      "script": "window_optimizer.py",
      "args_map": {
        "lottery-file": "lottery_file",
        "trials": "window_trials",
        "max-seeds": "seed_count",
        "prng-type": "prng_type",
        "strategy": "search_strategy",
        "forward-threshold": "forward_threshold",
        "reverse-threshold": "reverse_threshold",
        "test-both-modes": "test_both_modes"
      },
      "distributed": true,
      "timeout_minutes": 240
    }
  ],
  
  "follow_up_agents": ["scorer_meta_agent"],
  "success_condition": "optimal_window_config.json exists AND bidirectional_survivors.json has survivors > 0",
  "retry": 2,
  
  "parameter_bounds": {
    "window_size": {
      "type": "int",
      "min": 128,
      "max": 4096,
      "default": 512,
      "description": "Size of the temporal window (number of draws) for PRNG matching.",
      "optimized_by": "Optuna TPE",
      "effect": "Larger windows = more statistical power but slower. 256-1024 typical."
    },
    "offset": {
      "type": "int",
      "min": 0,
      "max": 2000,
      "default": 0,
      "description": "Time offset from current draw position.",
      "optimized_by": "Optuna TPE",
      "effect": "Non-zero offset may capture periodic PRNG reseeding patterns."
    },
    "skip_min": {
      "type": "int",
      "min": 0,
      "max": 50,
      "default": 0,
      "description": "Minimum skip value for variable skip PRNG patterns.",
      "optimized_by": "Optuna TPE",
      "effect": "Controls lower bound of skip range search."
    },
    "skip_max": {
      "type": "int",
      "min": 20,
      "max": 500,
      "default": 100,
      "description": "Maximum skip value for variable skip PRNG patterns.",
      "optimized_by": "Optuna TPE",
      "effect": "Controls upper bound of skip range search. Higher = more flexibility."
    },
    "forward_threshold": {
      "type": "float",
      "min": 0.50,
      "max": 0.95,
      "default": 0.72,
      "description": "Forward sieve match threshold. Higher = stricter filtering.",
      "optimized_by": "Optuna TPE",
      "effect": "Controls false positive rate in forward sieve. Values 0.70-0.85 typical."
    },
    "reverse_threshold": {
      "type": "float",
      "min": 0.60,
      "max": 0.98,
      "default": 0.81,
      "description": "Reverse sieve match threshold. Should be >= forward_threshold.",
      "optimized_by": "Optuna TPE",
      "effect": "Controls historical consistency check. Values 0.75-0.90 typical."
    },
    "window_trials": {
      "type": "int",
      "min": 10,
      "max": 200,
      "default": 50,
      "description": "Number of Optuna trials for window parameter optimization.",
      "optimized_by": "Manual",
      "effect": "More trials = better exploration but longer runtime. 50-100 typical."
    },
    "seed_count": {
      "type": "int",
      "min": 1000000,
      "max": 5000000000,
      "default": 50000000,
      "description": "Number of candidate seeds to test per trial.",
      "optimized_by": "Manual",
      "effect": "More seeds = higher recall but O(n) slower. 10M-100M for testing, 1B+ for production."
    },
    "search_strategy": {
      "type": "choice",
      "choices": ["bayesian", "random", "grid"],
      "default": "bayesian",
      "description": "Optuna search strategy for parameter space exploration.",
      "optimized_by": "Fixed",
      "effect": "bayesian (TPE) is most sample-efficient. Use random for quick sanity checks."
    },
    "test_both_modes": {
      "type": "bool",
      "default": false,
      "description": "Test BOTH constant AND variable skip patterns (V2.0 feature).",
      "optimized_by": "Manual",
      "effect": "Doubles search space but discovers variable skip patterns."
    }
  },
  
  "success_metrics": {
    "min_bidirectional_survivors": 1,
    "target_forward_survivors": 100,
    "target_reverse_survivors": 100,
    "max_false_positive_ratio": 0.1
  }
}
