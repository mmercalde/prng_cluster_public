{
  "agent_name": "scorer_meta_agent",
  "description": "Step 2.5: Distributed Optuna TPE meta-optimizer for scoring parameters. Finds optimal chunk_size, scoring weights, and threshold configurations across 26 GPUs.",
  "pipeline_step": 2,
  "version": "1.3.0",
  "required_inputs": [
    "bidirectional_survivors_binary.npz",
    "train_history.json",
    "holdout_history.json"
  ],
  "primary_output": "optimal_scorer_config.json",
  "feature_registry": "config_manifests/feature_registry.json",
  "inputs": [
    "bidirectional_survivors.json",
    "optimal_window_config.json",
    "lottery_file"
  ],
  "outputs": [
    "optimal_scorer_config.json",
    "scorer_meta_results.json"
  ],
  "actions": [
    {
      "type": "run_script",
      "script": "generate_scorer_jobs.py",
      "args_map": {
        "trials": "scorer_trials",
        "survivors": "survivors_file",
        "train-history": "train_history",
        "holdout-history": "holdout_history",
        "study-name": "study_name",
        "study-db": "study_db",
        "output": "output_file",
        "sample-size": "sample_size"
      },
      "distributed": false,
      "timeout_minutes": 10
    },
    {
      "type": "run_distributed",
      "script": "scorer_trial_worker.py",
      "args_map": {
        "job-file": "job_file",
        "gpu-id": "gpu_id"
      },
      "distributed": true,
      "timeout_minutes": 120
    }
  ],
  "follow_up_agents": [
    "full_scoring_agent"
  ],
  "success_condition": [
    "optimal_scorer_config.json"
  ],
  "retry": 2,
  "parameter_bounds": {
    "chunk_size": {
      "type": "int",
      "min": 100,
      "max": 10000,
      "default": 1000,
      "description": "Number of survivors processed per GPU job. Affects memory usage and parallelization efficiency.",
      "optimized_by": "Manual tuning",
      "effect": "Smaller chunks = more parallelism but higher overhead. Larger chunks = better GPU utilization but may OOM. Typical range 500-2000."
    },
    "scorer_trials": {
      "type": "int",
      "min": 10,
      "max": 500,
      "default": 100,
      "description": "Number of Optuna trials for scorer parameter optimization.",
      "optimized_by": "Optuna TPE",
      "effect": "More trials = better parameter discovery but longer runtime. 50-200 typical for production."
    },
    "match_weight": {
      "type": "float",
      "min": 0.1,
      "max": 2.0,
      "default": 1.0,
      "description": "Weight for exact match scoring component.",
      "optimized_by": "Optuna TPE",
      "effect": "Higher values emphasize exact matches over statistical similarity."
    },
    "residue_weight": {
      "type": "float",
      "min": 0.0,
      "max": 1.5,
      "default": 0.5,
      "description": "Weight for residue coherence (mod 8, mod 125) scoring component.",
      "optimized_by": "Optuna TPE",
      "effect": "Higher values emphasize lane agreement patterns."
    },
    "temporal_weight": {
      "type": "float",
      "min": 0.0,
      "max": 1.5,
      "default": 0.3,
      "description": "Weight for temporal stability scoring component.",
      "optimized_by": "Optuna TPE",
      "effect": "Higher values favor survivors with consistent historical performance."
    },
    "min_score_threshold": {
      "type": "float",
      "min": 0.01,
      "max": 0.5,
      "default": 0.1,
      "description": "Minimum score threshold to retain survivor for next stage.",
      "optimized_by": "Optuna TPE",
      "effect": "Higher = stricter filtering, fewer survivors passed to ML stage."
    }
  },
  "success_metrics": {
    "min_valid_trials": 10,
    "expected_completion_rate": 0.95,
    "max_trial_failures": 5
  },
  "default_params": {
    "trials": 100,
    "survivors": "bidirectional_survivors.json",
    "train_history": "train_history.json",
    "holdout_history": "holdout_history.json",
    "study_name": "scorer_meta_opt",
    "study_db": "sqlite:///optuna_studies/scorer_meta.db",
    "output": "scorer_jobs.json",
    "sample_size": 450
  },
  "evaluation_params": {
    "confidence_formula": "bit_length",
    "confidence_base": 0.7,
    "confidence_divisor": 64.0,
    "confidence_cap": 0.95,
    "zero_trials_confidence": 0.5,
    "min_successful_trials": 10
  },
  "arg_style": "positional",
  "positional_args": [
    "trials"
  ],
  "flag_args": [
    "legacy_scoring"
  ],
  "evaluation_type": "file_exists",
  "disable_llm_parsing": true,
  "disable_heuristic_parsing": true,
  "retry_policy": "none"
}
